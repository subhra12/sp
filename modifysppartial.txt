https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&display=swap

INSERT INTO #TimeData
SELECT 
    s.Emp_ID,
    NULL AS [Timesheet No],
    NULL AS [Approver HH Name],
    NULL AS [Approver PM Name],
    s.[Employee Name],
    s.[Employee Type],
    s.[Department],
    s.FromDate,
    s.ToDate,
    s.TransactionDate,
    NULL AS BookedHours,
    NULL AS ProjectNo,
    NULL AS [Project Description],
    NULL AS WBSNo,
    NULL AS WBSDescription,
    NULL AS PO,
    NULL AS BookedOn,
    NULL AS [Labour Rate],
    'Not Booked' AS Status,
    CAST(GETDATE() AS DATE) AS [Report Date],
    FORMAT(GETDATE(), 'hh:mm tt') AS [Report Time],
    s.[Month (for which the timecard is submitted)]
FROM (
    SELECT DISTINCT Emp_ID, [Employee Name], [Employee Type], [Department],
           FromDate, ToDate, TransactionDate, [Month (for which the timecard is submitted)]
    FROM #Stage
) s
WHERE NOT EXISTS (
    SELECT 1
    FROM #TimeData td
    WHERE td.Emp_ID = s.Emp_ID
      AND td.TransactionDate = s.TransactionDate
);

