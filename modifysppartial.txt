AND (
        -- Case 1: TransactionDate exists for employee → keep only rows with BookedHours > 0
        (EXISTS (
            SELECT 1
            FROM #Stage x
            WHERE x.Emp_ID = s.Emp_ID
              AND x.TransactionDate = s.TransactionDate
              AND x.BookedHours IS NOT NULL
        ) AND s.BookedHours > 0)

        -- Case 2: TransactionDate does not exist for employee → keep this row (Not Booked)
        OR NOT EXISTS (
            SELECT 1
            FROM #Stage x
            WHERE x.Emp_ID = s.Emp_ID
              AND x.TransactionDate = s.TransactionDate
              AND x.BookedHours IS NOT NULL
        )
    );
