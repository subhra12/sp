INSERT INTO #TimeData
SELECT *
FROM #Stage
WHERE BookedHours > 0 AND Status <> 'Unknown';

INSERT INTO #TimeData
SELECT 
    mu.EmpNo AS Emp_ID,
    NULL AS [Timesheet No],
    NULL AS [Approver HH Name],
    NULL AS [Approver PM Name],
    mu.EmployeeName AS [Employee Name],
    mu.UserType AS [Employee Type],
    mu.EmpDept AS [Department],
    wp.FromDate,
    wp.ToDate,
    wd.Date AS [TransactionDate],
    NULL AS BookedHours,
    NULL AS ProjectNo,
    NULL AS [Project Description],
    NULL AS WBSNo,
    NULL AS WBSDescription,
    NULL AS PO,
    NULL AS BookedOn,
    NULL AS [Labour Rate],
    'Not Booked' AS Status,
    CAST(GETDATE() AS DATE) AS [Report Date],
    FORMAT(GETDATE(), 'hh:mm tt') AS [Report Time],
    FORMAT(wp.FromDate, 'MMMM yyyy') AS [Month (for which the timecard is submitted)]
FROM dbo.MST_User mu
CROSS JOIN WeekPeriods wp
JOIN WeekDays wd ON wd.FromDate = wp.FromDate AND wd.ToDate = wp.ToDate
WHERE mu.InactiveDate IS NULL
  AND NOT EXISTS (
      SELECT 1
      FROM #TimeData td
      WHERE td.Emp_ID = mu.EmpNo
        AND td.TransactionDate = wd.Date
  );
SELECT * FROM #TimeData
ORDER BY [Employee Name], FromDate, TransactionDate;
